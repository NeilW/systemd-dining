#!/bin/sh
set -e

count() {
    case ${1##*/} in
        \*)
            echo 0
            ;;
        *)
            echo $#
            ;;
    esac
}

diningroom=/home/share/dining-room
forkarea=${diningroom}/forks

lfork=$(my-dining-seat)
total=$(count ${diningroom}/seats/*)
rfork=$((lfork+1))
if [ "${rfork}" -gt "${total}" ]
then
    rfork=1
fi

if [ -w "${forkarea}/${lfork}" ] &&
   [ -w "${forkarea}/${rfork}" ] &&
   [ ! -k "${forkarea}/${lfork}" ] &&
   [ ! -k "${forkarea}/${rfork}" ]
then
    echo "I have two clean forks"
    exit 0
fi
exit 1
